openapi: 3.0.0
info:
  title: "Fireblocks Provider Ramps API"
  version: 0.0.1

  contact:
    name: Fireblocks
    url: https://fireblocks.com

tags:
  - name: capabilities
    description: Server capabilities discovery operations.
  - name: ramps
    description: |-
      Beta Feature â€“ Limited Access.

      On-ramp, off-ramp and bridging operations.

x-path-params:
  EntityIdPathParam:
    { $ref: "./fb-provider-api.yaml#/components/parameters/EntityIdPathParam" }
  SubAccountIdPathParam:
    {
      $ref: "./fb-provider-api.yaml#/components/parameters/SubAccountIdPathParam",
    }

x-query-params:
  PaginationLimit:
    { $ref: "./fb-provider-api.yaml#/components/parameters/PaginationLimit" }
  PaginationStartingAfter:
    {
      $ref: "./fb-provider-api.yaml#/components/parameters/PaginationStartingAfter",
    }
  PaginationEndingBefore:
    {
      $ref: "./fb-provider-api.yaml#/components/parameters/PaginationEndingBefore",
    }
  ListOrderQueryParam:
    {
      $ref: "./fb-provider-api.yaml#/components/parameters/ListOrderQueryParam",
    }

x-header-params:
  X-FBAPI-KEY:
    { $ref: "./fb-provider-api.yaml#/components/parameters/X-FBAPI-KEY" }
  X-FBAPI-SIGNATURE:
    { $ref: "./fb-provider-api.yaml#/components/parameters/X-FBAPI-SIGNATURE" }
  X-FBAPI-NONCE:
    { $ref: "./fb-provider-api.yaml#/components/parameters/X-FBAPI-NONCE" }
  X-FBAPI-TIMESTAMP:
    { $ref: "./fb-provider-api.yaml#/components/parameters/X-FBAPI-TIMESTAMP" }

x-schemas:
  PositiveAmount:
    { $ref: "./fb-provider-api.yaml#/components/schemas/PositiveAmount" }
  PublicBlockchainCapability:
    {
      $ref: "./fb-provider-api.yaml#/components/schemas/PublicBlockchainCapability",
    }
  PublicBlockchainAddress:
    {
      $ref: "./fb-provider-api.yaml#/components/schemas/PublicBlockchainAddress",
    }
  FiatCapability:
    {
      $ref: "./fb-provider-transfer-api.yaml#/components/schemas/FiatCapability",
    }
  NationalCurrency:
    { $ref: "./fb-provider-api.yaml#/components/schemas/NationalCurrency" }
  CryptocurrencyReference:
    {
      $ref: "./fb-provider-api.yaml#/components/schemas/CryptocurrencyReference",
    }
  AssetReference:
    { $ref: "./fb-provider-api.yaml#/components/schemas/AssetReference" }
  FiatAddress:
    { $ref: "./fb-provider-transfer-api.yaml#/components/schemas/FiatAddress" }
  IbanTransfer:
    { $ref: "./fb-provider-transfer-api.yaml#/components/schemas/IbanTransfer" }
  AchTransfer:
    { $ref: "./fb-provider-transfer-api.yaml#/components/schemas/AchTransfer" }
  WireTransfer:
    { $ref: "./fb-provider-transfer-api.yaml#/components/schemas/WireTransfer" }
  SpeiTransfer:
    { $ref: "./fb-provider-transfer-api.yaml#/components/schemas/SpeiTransfer" }
  PixTransfer:
    { $ref: "./fb-provider-transfer-api.yaml#/components/schemas/PixTransfer" }
  EuropeanSEPATransfer:
    {
      $ref: "./fb-provider-transfer-api.yaml#/components/schemas/EuropeanSEPATransfer",
    }
  MobileMoneyTransfer:
    {
      $ref: "./fb-provider-transfer-api.yaml#/components/schemas/MobileMoneyTransfer",
    }
  LocalBankTransfer:
    {
      $ref: "./fb-provider-transfer-api.yaml#/components/schemas/LocalBankTransfer",
    }
  PublicBlockchainTransaction:
    {
      $ref: "./fb-provider-transfer-api.yaml#/components/schemas/PublicBlockchainTransaction",
    }
  ParticipantsIdentification:
    {
      $ref: "./fb-provider-transfer-api.yaml#/components/schemas/ParticipantsIdentification",
    }
  JweString:
    { $ref: "./fb-provider-transfer-api.yaml#/components/schemas/JweString" }

x-responses:
  BadRequestResponse:
    { $ref: "./fb-provider-api.yaml#/components/responses/BadRequestResponse" }
  UnauthorizedResponse:
    {
      $ref: "./fb-provider-api.yaml#/components/responses/UnauthorizedResponse",
    }
  ErrorResponse:
    { $ref: "./fb-provider-api.yaml#/components/responses/ErrorResponse" }

paths:
  /accounts/{accountId}/capabilities/ramps:
    get:
      operationId: getRampMethods
      summary: Get list of supported ramp methods
      description: >
        Retrieves the list of supported on-ramp and off-ramp methods available for the specified account.
        Shows which payment methods and currencies are supported for fiat-to-crypto and crypto-to-fiat conversions.
      tags: [capabilities]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-query-params/PaginationLimit"
        - $ref: "#/x-query-params/PaginationStartingAfter"
        - $ref: "#/x-query-params/PaginationEndingBefore"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
      responses:
        "200":
          $ref: "#/components/responses/RampMethodsResponse"
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"

  /accounts/{accountId}/ramps:
    get:
      operationId: getRamps
      summary: Get list of ramps sorted by creation time
      description: >
        Retrieves a paginated list of all ramp transactions for the specified account.
        Ramps are sorted by creation time and include both on-ramp and off-ramp operations.
      tags: [ramps]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-query-params/PaginationLimit"
        - $ref: "#/x-query-params/PaginationStartingAfter"
        - $ref: "#/x-query-params/PaginationEndingBefore"
        - $ref: "#/x-query-params/ListOrderQueryParam"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
      responses:
        "200":
          $ref: "#/components/responses/GetRampsResponse"
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"
    post:
      operationId: createRamp
      summary: Initiates a new ramp
      description:
        Creates the payment instructions for the new ramp and return it in
        the response.
      tags: [ramps]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
      requestBody:
        description: Ramp details
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RampRequest"
      responses:
        "201":
          $ref: "#/components/responses/CreateRampResponse"
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"

  /accounts/{accountId}/ramps/requirements:
    get:
      operationId: getRampCreationRequirements
      summary: Get requirements for creating a new ramp
      description: >
        Retrieves the requirements for creating a new ramp, including any necessary
        certificates (public keys) for encrypting PII data.
      tags: [ramps]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
        - $ref: "#/components/parameters/RampRequirementsQuoteIdQueryParam"
      responses:
        "200":
          description: Ramp creation requirements.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RampRequirements"
              examples:
                default:
                  value:
                    piiEncryption:
                      certificate:
                        id: "c4d1da72-111e-4d52-bdbf-2e74a2d803d5"
                        domain: "example.com"
                        certPEM: "LS0tLS1CRUdJT..."
                        jwk:
                          kty: "EC"
                          crv: "P-256"
                          kid: "263521881931753643998528753619816524468853605762"
                          x: "KnxBe8fb2mL_Ve9-tqjGSkGgE9f0yohMkAvH_InaFtE"
                          y: "D41cVUpiKcey4LJKNFtUtmVHDWRmhjZapPLfryX5b1o"
                      fieldRequirements:
                        type: "object"
                        required:
                          - "originator.fullName"
                          - "originator.dateOfBirth"
                          - "beneficiary.fullName"
                          - "beneficiary.registrationNumber"
                        properties:
                          originator.fullName:
                            type: "string"
                          originator.dateOfBirth:
                            type: "string"
                            format: "date"
                          beneficiary.fullName:
                            type: "string"
                          beneficiary.registrationNumber:
                            type: "string"
                      fileRequirements:
                        - "ID_DOCUMENT"
                        - "PROOF_OF_ADDRESS_DOCUMENT"
                      supportedJWEAlgorithms:
                        - "RSA-OAEP-256"
                        - "ECDH-ES+A128KW"
                      supportedJWEEncryptions:
                        - "A128GCM"
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"

  /accounts/{accountId}/ramps/{rampId}:
    get:
      operationId: getRampDetails
      summary: Get details of a specific ramp
      description: >
        Retrieves detailed information about a specific ramp transaction, including
        payment instructions, status, amounts, and processing details.
      tags: [ramps]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
        - $ref: "#/x-path-params/EntityIdPathParam"
      responses:
        "200":
          $ref: "#/components/responses/GetRampDetailsResponse"
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"

  /accounts/{accountId}/ramps/{rampId}/payment:
    post:
      operationId: submitSignedPaymentPermit
      summary: Submit signed payment permit for a ramp
      description: >
        Submits the signed payment permit string back to the provider for broadcasting.
        This is used in flows where the user is the payment permit originator.
      tags: [ramps]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
        - $ref: "#/x-path-params/EntityIdPathParam"
      requestBody:
        description: Signed payment permit details
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SubmitSignedPaymentPermitRequest"
      responses:
        "200":
          $ref: "#/components/responses/GetRampDetailsResponse"
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"

  /accounts/{accountId}/ramps/{rampId}/rfi/bulk:
    post:
      operationId: submitRFIBulk
      summary: Submit RFI bulk for a ramp
      description: >
        Submits the RFI bulk details back to the provider for processing.
      tags: [ramps]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
        - $ref: "#/x-path-params/EntityIdPathParam"
      requestBody:
        description: RFI bulk details
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RequestForInformationBulkSubmission"
      responses:
        "200":
          $ref: "#/components/responses/GetRampDetailsResponse"
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"

  /accounts/{accountId}/ramps/{rampId}/rfi/{rfiId}/files:
    post:
      operationId: uploadRfiFile
      summary: Upload encrypted RFI file
      description: >
        Upload an encrypted file for a specific RFI. Files must be encrypted using AES-128-GCM,
        with the AES key encrypted using JWE (ECDH-ES+A128KW algorithm with A128GCM encryption).
        
        The request must be sent as multipart/form-data with three parts:
        - fileMetadata: JSON object with file details
        - encryption: JSON object with encrypted AES key and IV
        - encryptedFile: The encrypted binary file data
      tags: [ramps]
      parameters:
        - $ref: "#/x-header-params/X-FBAPI-KEY"
        - $ref: "#/x-header-params/X-FBAPI-NONCE"
        - $ref: "#/x-header-params/X-FBAPI-SIGNATURE"
        - $ref: "#/x-header-params/X-FBAPI-TIMESTAMP"
        - $ref: "#/x-path-params/SubAccountIdPathParam"
        - $ref: "#/x-path-params/EntityIdPathParam"
        - name: rfiId
          in: path
          description: The ID of the RFI for which the file is being uploaded.
          required: true
          schema:
            type: string
      requestBody:
        description: Encrypted file upload with metadata and encryption details
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: "#/components/schemas/UploadRfiFileRequest"
      responses:
        "204":
          description: RFI file uploaded successfully.
        "400":
          $ref: "#/x-responses/BadRequestResponse"
        "401":
          $ref: "#/x-responses/UnauthorizedResponse"
        "404":
          description: Ramp or RFI not found.
        "4XX":
          $ref: "#/x-responses/ErrorResponse"
        "5XX":
          $ref: "#/x-responses/ErrorResponse"

components:
  parameters:
    RampRequirementsQuoteIdQueryParam:
      name: quoteId
      in: query
      description: The ID of the quote for which requirements are needed.
      schema:
        type: string
  responses:
    RampMethodsResponse:
      description: List of ramp methods for account.
      content:
        application/json:
          schema:
            type: object
            required: [capabilities]
            properties:
              capabilities:
                type: array
                items:
                  $ref: "#/components/schemas/RampMethod"
          examples:
            allUsdMethods:
              summary: USDs ramps
              description: >-
                This response indicates that on ramp from USD to USDC, off 
                ramp from USDC to USD and bridging between USDC and USDC on 
                different blockchains are supported. The USD asset can be 
                specified directly while tokens must be defined in 
                `GET /capabilities/assets` and referenced using their IDs.

                The asset IDs in this example are the same IDs used in the 
                examples of `GET /capabilities/assets`.
              value:
                capabilities:
                  - id: "16b8b2c3-bd61-4745-9c48-3d30c2bc6907"
                    from:
                      asset:
                        nationalCurrencyCode: "USD"
                      transferMethod: "Iban"
                    to:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                  - id: "69fa4f38-c1fd-4215-a310-82272225c4ef"
                    from:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                    to:
                      asset:
                        nationalCurrencyCode: "USD"
                      transferMethod: "Iban"
                  - id: "afc7caa0-5b7e-4c98-8f2a-a037d0c6bbea"
                    from:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                    to:
                      asset:
                        assetId: "606bce6b-ff15-4704-9390-b9e32a6cfcff" # USDC on Polygon
                      transferMethod: "PublicBlockchain"

    CreateRampResponse:
      description: New ramp has been successfully created.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Ramp"
          examples:
            onRamp:
              summary: OnRamp
              description: A standard fiat to crypto on-ramp without additional features.
              value:
                id: "16b8b2c3-bd61-4745-9c48-3d30c2bc6907"
                createdAt: "2021-09-01T12:00:00Z"
                updatedAt: "2021-09-01T12:00:00Z"
                status: "Pending"
                amount: "1000.00"
                type: "OnRamp"
                expiresAt: "2021-09-01T12:00:00Z"
                from:
                  asset:
                    nationalCurrencyCode: "USD"
                  transferMethod: "Iban"
                to:
                  asset:
                    assetId: "360de0ad-9ba1-45d5-8074-22453f193d65"
                  transferMethod: "PublicBlockchain"
                  address: "0x1234567890abcdef1234567890abcdef12345678"
                paymentInstructions:
                  asset:
                    nationalCurrencyCode: "USD"
                  transferMethod: "Iban"
                  accountHolder:
                    name: "John Doe"
                    address: "123 Main St, New York, NY 10001"
                  iban: "US1234567890"
                estimatedFees:
                  - feeType: "ORDER"
                    feeAsset:
                      nationalCurrencyCode: "USD"
                    fee:
                      amountType: "FIXED"
                      amount: "100.00"
            onRampWithQuote:
              summary: OnRamp with Quote
              description: An on-ramp that includes quote information for price execution.
              value:
                id: "69fa4f38-c1fd-4215-a310-82272225c4ef"
                createdAt: "2021-09-01T12:00:00Z"
                updatedAt: "2021-09-01T12:00:00Z"
                status: "Pending"
                amount: "500.00"
                type: "OnRamp"
                expiresAt: "2021-09-01T12:00:00Z"
                from:
                  asset:
                    nationalCurrencyCode: "USD"
                  transferMethod: "Iban"
                to:
                  asset:
                    assetId: "606bce6b-ff15-4704-9390-b9e32a6cfcff"
                  transferMethod: "PublicBlockchain"
                  address: "0xabcdef1234567890abcdef1234567890abcdef12"
                paymentInstructions:
                  asset:
                    nationalCurrencyCode: "USD"
                  transferMethod: "Iban"
                  accountHolder:
                    name: "Jane Smith"
                    address: "456 Oak Street, London, UK"
                  iban: "US1234567890"
                executionDetails:
                  type: "Quote"
                  quoteId: "quote-123456789"
                  reQuote:
                    type: "Retry"
                    slippage: 0.02
                    count: 3
                estimatedFees:
                  - feeType: "ORDER"
                    feeAsset:
                      nationalCurrencyCode: "USD"
                    fee:
                      amountType: "FIXED"
                      amount: "100.00"
            offRampWithSigning:
              summary: OffRamp with Signing Message
              description: An off-ramp that returns an EIP-712 message to be signed by the user.
              value:
                id: "afc7caa0-5b7e-4c98-8f2a-a037d0c6bbea"
                createdAt: "2021-09-01T12:00:00Z"
                updatedAt: "2021-09-01T12:00:00Z"
                status: "Pending"
                amount: "1000.00"
                type: "OffRamp"
                expiresAt: "2021-09-01T12:00:00Z"
                from:
                  asset:
                    assetId: "360de0ad-9ba1-45d5-8074-22453f193d65"
                  transferMethod: "PublicBlockchain"
                  address: "0x1234567890abcdef1234567890abcdef12345678"
                to:
                  asset:
                    nationalCurrencyCode: "USD"
                  transferMethod: "Iban"
                  accountHolder:
                    name: "John Doe"
                paymentInstructions:
                  type: "EVM_EIP712"
                  message:
                    types:
                      EIP712Domain:
                        - name: name
                          type: string
                        - name: version
                          type: string
                        - name: chainId
                          type: uint256
                        - name: verifyingContract
                          type: address
                      Permit:
                        - name: owner
                          type: address
                        - name: spender
                          type: address
                        - name: value
                          type: uint256
                        - name: nonce
                          type: uint256
                        - name: deadline
                          type: uint256
                    primaryType: "Permit"
                    domain:
                      name: "USD Coin"
                      version: "2"
                      chainId: 1
                      verifyingContract: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"
                    message:
                      owner: "0x1234567890abcdef1234567890abcdef12345678"
                      spender: "0xabcdef1234567890abcdef1234567890abcdef12"
                      value: "1000000"
                      nonce: 0
                      deadline: 1736035200
                estimatedFees:
                  - feeType: "ORDER"
                    feeAsset:
                      nationalCurrencyCode: "USD"
                    fee:
                      amountType: "FIXED"
                      amount: "10.00"

    GetRampDetailsResponse:
      description: Ramp details.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Ramp"

    GetRampsResponse:
      description: List of ramps for account.
      content:
        application/json:
          schema:
            type: object
            required: [ramps]
            properties:
              ramps:
                type: array
                items:
                  $ref: "#/components/schemas/Ramp"
          examples:
            allRamps:
              summary: All ramps
              description: >-
                This response indicates that there are 3 ramps in the account.
              value:
                ramps:
                  - id: "16b8b2c3-bd61-4745-9c48-3d30c2bc6907"
                    createdAt: "2021-09-01T12:00:00Z"
                    updatedAt: "2021-09-01T12:00:00Z"
                    status: "Pending"
                    amount: "1231.45"
                    type: "OnRamp"
                    from:
                      asset:
                        nationalCurrencyCode: "USD"
                      transferMethod: "Iban"
                    to:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65"
                      transferMethod: "PublicBlockchain"
                      address: "0x1234567890abcdef1234567890abcdef12345678"
                      tag: "1234567890abcdef"
                    paymentInstructions:
                      asset:
                        nationalCurrencyCode: "USD"
                      transferMethod: "Iban"
                      accountHolder:
                        name: "John Doe"
                        address: "123 Main St, New York, NY 10001"
                      iban: "US1234567890"
                    estimatedFees:
                      - feeType: "ORDER"
                        feeAsset:
                          nationalCurrencyCode: "USD"
                        fee:
                          amountType: "FIXED"
                          amount: "100.00"
                    expiresAt: "2021-09-01T12:00:00Z"
                  - id: "69fa4f38-c1fd-4215-a310-82272225c4ef"
                    createdAt: "2021-09-01T12:00:00Z"
                    updatedAt: "2021-09-01T12:00:00Z"
                    status: "Completed"
                    amount: "1231.45"
                    type: "OffRamp"
                    from:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                    to:
                      asset:
                        nationalCurrencyCode: "USD"
                      transferMethod: "Iban"
                      accountHolder:
                        name: "John Doe"
                        address: "123 Main St, New York, NY 10001"
                      iban: "US1234567890"
                    paymentInstructions:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                      address: "0x1234567890abcdef1234567890abcdef12345678"
                    payment:
                      blockchainTxId: "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"
                      amount: "1231.45"
                      address: "0x1234567890abcdef1234567890abcdef12345678"
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                    receipt:
                      asset:
                        nationalCurrencyCode: "USD"
                      transferMethod: "Iban"
                      accountHolder:
                        name: "John Doe"
                        address: "123 Main St, New York, NY 10001"
                      iban: "US1234567890"
                      amount: "1231.45"
                      actualFees:
                        - feeType: "ORDER"
                          feeAsset:
                            nationalCurrencyCode: "USD"
                          fee:
                            amountType: "FIXED"
                            amount: "100.00"
                    expiresAt: "2021-09-01T12:00:00Z"
                  - id: "afc7caa0-5b7e-4c98-8f2a-a037d0c6bbea"
                    createdAt: "2021-09-01T12:00:00Z"
                    updatedAt: "2021-09-01T12:00:00Z"
                    status: "Processing"
                    amount: "1231.45"
                    type: "Bridge"
                    from:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                    to:
                      asset:
                        assetId: "606bce6b-ff15-4704-9390-b9e32a6cfcff"
                      transferMethod: "PublicBlockchain"
                      address: "0x1234567890abcdef1234567890abcdef12345678"
                      tag: "1234567890abcdef"
                    paymentInstructions:
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                      address: "0x1234567890abcdef1234567890abcdef12355678"
                    payment:
                      blockchainTxId: "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef"
                      amount: "1231.45"
                      address: "0x1234567890abcdef1234567890abcdef12355678"
                      asset:
                        assetId: "360de0ad-9ba1-45d5-8074-22453f193d65" # USDC on Ethereum
                      transferMethod: "PublicBlockchain"
                    receipt:
                      actualFees:
                        - feeType: "ORDER"
                          feeAsset:
                            nationalCurrencyCode: "USD"
                          fee:
                            amountType: "FIXED"
                            amount: "100.00"
                      blockchainTxId: "0x1234567890abcdef1234567899abcdef1234567890abcdef1234567890abcdef"
                      amount: "1231.45"
                      address: "0x1234567890abcdef1234567890abcdef12345678"
                      asset:
                        assetId: "606bce6b-ff15-4704-9390-b9e32a6cfcff" # USDC on Polygon
                      transferMethod: "PublicBlockchain"
                    estimatedFees:
                      - feeType: "ORDER"
                        feeAsset:
                          nationalCurrencyCode: "USD"
                        fee:
                          amountType: "FIXED"
                          amount: "100.00"
                    expiresAt: "2021-09-01T12:00:00Z"
  schemas:
    RampStatus:
      enum:
        - Pending
        - PendingRFISubmission
        - Processing
        - Canceled
        - Completed
        - Failed
        - Refunded

    PrefundedOnRampCapability:
      type: object
      title: Prefunded Fiat to Crypto
      required: [from, to]
      properties:
        from:
          $ref: "#/components/schemas/PrefundedFiatCapability"
        to:
          $ref: "#/x-schemas/PublicBlockchainCapability"

    OnRampCapability:
      type: object
      title: Fiat to Crypto
      required: [from, to]
      properties:
        from:
          $ref: "#/x-schemas/FiatCapability"
        to:
          $ref: "#/x-schemas/PublicBlockchainCapability"

    PrefundedOffRampCapability:
      type: object
      title: Prefunded Crypto to Fiat
      required: [from, to]
      properties:
        from:
          $ref: "#/components/schemas/PrefundedBlockchainCapability"
        to:
          $ref: "#/x-schemas/FiatCapability"

    OffRampCapability:
      type: object
      title: Crypto to Fiat
      required: [from, to]
      properties:
        from:
          $ref: "#/x-schemas/PublicBlockchainCapability"
        to:
          $ref: "#/x-schemas/FiatCapability"

    PrefundedBridgeCapability:
      type: object
      title: Prefunded Crypto to Crypto
      required: [from, to]
      properties:
        from:
          $ref: "#/components/schemas/PrefundedBlockchainCapability"
        to:
          $ref: "#/x-schemas/PublicBlockchainCapability"

    BridgeCapability:
      type: object
      title: Crypto to Crypto
      required: [from, to]
      properties:
        from:
          $ref: "#/x-schemas/PublicBlockchainCapability"
        to:
          $ref: "#/x-schemas/PublicBlockchainCapability"

    RampMethod:
      allOf:
        - type: object
          required: [id]
          properties:
            id:
              type: string
            hasRequirements:
              type: boolean
        - oneOf:
            - $ref: "#/components/schemas/OnRampCapability"
            - $ref: "#/components/schemas/PrefundedOnRampCapability"
            - $ref: "#/components/schemas/OffRampCapability"
            - $ref: "#/components/schemas/PrefundedOffRampCapability"
            - $ref: "#/components/schemas/BridgeCapability"
            - $ref: "#/components/schemas/PrefundedBridgeCapability"

    BlockchainCapabilityWithOptionalAddress:
      title: Blockchain Capability With Address
      allOf:
        - $ref: "#/x-schemas/PublicBlockchainCapability"
        - type: object
          properties:
            address:
              type: string

    PrefundedFiatCapability:
      type: object
      required:
        - asset
        - type
      properties:
        asset:
          $ref: "#/x-schemas/NationalCurrency"
        type:
          type: string
          enum:
            - Prefunded

    PrefundedBlockchainCapability:
      type: object
      required:
        - asset
        - type
      properties:
        asset:
          $ref: "#/x-schemas/CryptocurrencyReference"
        type:
          type: string
          enum:
            - Prefunded

    PrefundedOnRampProperties:
      type: object
      title: On Ramp - Prefunded
      required:
        - type
        - from
        - to
      properties:
        type:
          type: string
          enum:
            - OnRamp
        from:
          $ref: "#/components/schemas/PrefundedFiatCapability"
        to:
          $ref: "#/x-schemas/PublicBlockchainAddress"

    OnRampProperties:
      type: object
      title: On Ramp
      required:
        - type
        - from
        - to
      properties:
        type:
          type: string
          enum:
            - OnRamp
        from:
          $ref: "#/x-schemas/FiatCapability"
        to:
          $ref: "#/x-schemas/PublicBlockchainAddress"

    PrefundedOffRampProperties:
      type: object
      title: Off Ramp - Prefunded
      required:
        - type
        - from
        - to
      properties:
        type:
          type: string
          enum:
            - OffRamp
        from:
          $ref: "#/components/schemas/PrefundedBlockchainCapability"
        to:
          $ref: "#/x-schemas/FiatAddress"

    OffRampProperties:
      type: object
      title: Off Ramp
      required:
        - type
        - from
        - to
      properties:
        type:
          type: string
          enum:
            - OffRamp
        from:
          $ref: "#/components/schemas/BlockchainCapabilityWithOptionalAddress"
        to:
          $ref: "#/x-schemas/FiatAddress"

    PrefundedBridgeProperties:
      type: object
      title: Bridge - Prefunded
      required:
        - type
        - from
        - to
      properties:
        type:
          type: string
          enum:
            - Bridge
        from:
          $ref: "#/components/schemas/PrefundedBlockchainCapability"
        to:
          $ref: "#/x-schemas/PublicBlockchainAddress"

    BridgeProperties:
      type: object
      title: Bridge
      required:
        - type
        - from
        - to
      properties:
        type:
          type: string
          enum:
            - Bridge
        from:
          $ref: "#/components/schemas/BlockchainCapabilityWithOptionalAddress"
        to:
          $ref: "#/x-schemas/PublicBlockchainAddress"

    CommonRampRequestProperties:
      type: object
      required:
        - idempotencyKey
        - amount
      properties:
        idempotencyKey:
          type: string
        amount:
          $ref: "#/x-schemas/PositiveAmount"

    RampRequest:
      allOf:
        - $ref: "#/components/schemas/CommonRampRequestProperties"
        - oneOf:
            # - $ref: "#/components/schemas/OnRampProperties"
            # - $ref: "#/components/schemas/PrefundedOnRampProperties"
            - $ref: "#/components/schemas/OffRampProperties"
            # - $ref: "#/components/schemas/PrefundedOffRampProperties"
            # - $ref: "#/components/schemas/BridgeProperties"
            # - $ref: "#/components/schemas/PrefundedBridgeProperties"
        - type: object
          properties:
            executionDetails:
              oneOf:
                - $ref: "#/components/schemas/OrderQuote"
        - type: object
          properties:
            participantsIdentification:
              oneOf:
                - $ref: "#/x-schemas/JweString"
                - $ref: "#/x-schemas/ParticipantsIdentification"

    FixedFeeAmount:
      type: object
      required:
        - amountType
        - amount
      properties:
        amountType:
          type: string
          enum:
            - FIXED
        amount:
          $ref: "#/x-schemas/PositiveAmount"

    BasisPointsFeeAmount:
      type: object
      required:
        - amountType
        - amount
      properties:
        amountType:
          type: string
          enum:
            - BASIS_POINTS
        amount:
          type: number
          description: Basis points (bps) - 1 is 0.01% and 10000 is 100%

    FeeAmount:
      oneOf:
        - $ref: "#/components/schemas/FixedFeeAmount"
        - $ref: "#/components/schemas/BasisPointsFeeAmount"

    Fee:
      type: object
      required:
        - feeType
        - feeAsset
        - fee
      properties:
        feeType:
          type: string
          description: >
            Specifies the category of fee applied to the transaction.
            - ORDER - Fee charged by the platform for executing the trade.
            - NETWORK - Blockchain network fee paid to validators/miners.
            - SPREAD - Implicit cost built into the price difference between quotes.
            - REBATE - Negative fee returned to the user as a reward or incentive.
          enum:
            - ORDER
            - NETWORK
            - SPREAD
            - REBATE
        feeAsset:
          $ref: "#/x-schemas/AssetReference"
        fee:
          $ref: "#/components/schemas/FeeAmount"

    RampFees:
      type: array
      items:
        $ref: "#/components/schemas/Fee"

    CommonRamp:
      type: object
      required: [id, status, createdAt, updatedAt, amount, expiresAt]
      properties:
        id:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        status:
          $ref: "#/components/schemas/RampStatus"
        amount:
          $ref: "#/x-schemas/PositiveAmount"
        estimatedFees:
          $ref: "#/components/schemas/RampFees"
        executionDetails:
          oneOf:
            - $ref: "#/components/schemas/OrderQuote"
        expiresAt:
          description: Ramp expiration time.
          type: string
          format: date-time
        rfis:
          type: array
          description: >
            List of requests for information for the ramp.
            When the ramp is in AdditionalInformationRequired status, each RFI must be submitted via /accounts/{accountId}/ramps/{rampId}/rfi.
          items:
            $ref: "#/components/schemas/RequestForInformation"

    OnRampPropertiesWithPaymentInstructions:
      type: object
      title: On Ramp
      allOf:
        - type: object
          required:
            - paymentInstructions
          properties:
            paymentInstructions:
              allOf:
                - $ref: "#/x-schemas/FiatAddress"
                - type: object
                  properties:
                    referenceId:
                      type: string
        - $ref: "#/components/schemas/OnRampProperties"

    OffRampPropertiesWithPaymentInstructions:
      type: object
      title: Off Ramp
      allOf:
        - type: object
          required:
            - paymentInstructions
          properties:
            paymentInstructions:
              oneOf:
                - $ref: "#/x-schemas/PublicBlockchainAddress"
                - $ref: "#/components/schemas/SigningMessage"
        - $ref: "#/components/schemas/OffRampProperties"

    BridgePropertiesWithPaymentInstructions:
      type: object
      title: Bridge
      allOf:
        - type: object
          required:
            - paymentInstructions
          properties:
            paymentInstructions:
              $ref: "#/x-schemas/PublicBlockchainAddress"
        - $ref: "#/components/schemas/BridgeProperties"

    OnRampReceipt:
      allOf:
        - $ref: "#/x-schemas/PublicBlockchainTransaction"
        - type: object
          properties:
            actualFees:
              $ref: "#/components/schemas/RampFees"

    OffRampReceipt:
      allOf:
        - $ref: "#/components/schemas/RampFiatTransfer"
        - type: object
          properties:
            actualFees:
              $ref: "#/components/schemas/RampFees"

    BridgeReceipt:
      allOf:
        - $ref: "#/x-schemas/PublicBlockchainTransaction"
        - type: object
          properties:
            actualFees:
              $ref: "#/components/schemas/RampFees"

    OnRamp:
      title: On Ramp
      allOf:
        - $ref: "#/components/schemas/CommonRamp"
        - oneOf:
            - $ref: "#/components/schemas/OnRampPropertiesWithPaymentInstructions"
            - $ref: "#/components/schemas/PrefundedOnRampProperties"
        - type: object
          properties:
            receipt:
              $ref: "#/components/schemas/OnRampReceipt"

    OffRamp:
      allOf:
        - $ref: "#/components/schemas/CommonRamp"
        - oneOf:
            - $ref: "#/components/schemas/OffRampPropertiesWithPaymentInstructions"
            # - $ref: "#/components/schemas/PrefundedOffRampProperties"
        - type: object
          properties:
            receipt:
              $ref: "#/components/schemas/OffRampReceipt"

    Bridge:
      allOf:
        - $ref: "#/components/schemas/CommonRamp"
        - oneOf:
            - $ref: "#/components/schemas/BridgePropertiesWithPaymentInstructions"
            - $ref: "#/components/schemas/PrefundedBridgeProperties"
        - type: object
          properties:
            receipt:
              $ref: "#/components/schemas/BridgeReceipt"

    Ramp:
      oneOf:
        # - $ref: "#/components/schemas/OnRamp"
        - $ref: "#/components/schemas/OffRamp"
        # - $ref: "#/components/schemas/Bridge"

    RampFiatTransfer:
      oneOf:
        - $ref: "#/x-schemas/IbanTransfer"
        - $ref: "#/x-schemas/AchTransfer"
        - $ref: "#/x-schemas/WireTransfer"
        - $ref: "#/x-schemas/SpeiTransfer"
        - $ref: "#/x-schemas/PixTransfer"
        - $ref: "#/x-schemas/EuropeanSEPATransfer"
        - $ref: "#/x-schemas/LocalBankTransfer"
        - $ref: "#/x-schemas/MobileMoneyTransfer"

    OrderQuote:
      type: object
      required:
        - type
        - quoteId
      properties:
        type:
          type: string
          enum:
            - Quote
        quoteId:
          type: string
        reQuote:
          oneOf:
            - $ref: "#/components/schemas/Retry"
            - $ref: "#/components/schemas/Market"

    SigningMessage:
      oneOf:
        - $ref: "#/components/schemas/EVM_EIP712SigningMessage"
        - $ref: "#/components/schemas/SolanaSigningMessage"
      discriminator:
        propertyName: type

    EVM_EIP712SigningMessage:
      type: object
      required: [type, message]
      properties:
        type:
          type: string
          enum: [EVM_EIP712]
        message:
          $ref: "#/components/schemas/EIP712Message"
      example:
        type: "EVM_EIP712"
        message:
          types:
            EIP712Domain:
              - name: name
                type: string
              - name: version
                type: string
              - name: chainId
                type: uint256
              - name: verifyingContract
                type: address
            Permit:
              - name: owner
                type: address
              - name: spender
                type: address
              - name: value
                type: uint256
              - name: nonce
                type: uint256
              - name: deadline
                type: uint256
          primaryType: "Permit"
          domain:
            name: "USD Coin"
            version: "2"
            chainId: 1
            verifyingContract: "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"
          message:
            owner: "0x1234567890abcdef1234567890abcdef12345678"
            spender: "0xabcdef1234567890abcdef1234567890abcdef12"
            value: "1000000"
            nonce: 0
            deadline: 1736035200

    SolanaSigningMessage:
      type: object
      required: [type, transaction]
      properties:
        type:
          type: string
          enum: [SOLANA_TRANSACTION]
        transaction:
          type: string
          description: Base64 encoded serialized Solana VersionedTransaction.
      example:
        type: "SOLANA_TRANSACTION"
        transaction: "AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="

    EIP712Message:
      type: object
      description: EIP-712 message to be signed.
      required: [types, primaryType, domain, message]
      properties:
        types:
          type: object
          description: Type definitions for the message.
        primaryType:
          type: string
          description: The primary type of the message.
        domain:
          type: object
          description: The domain separator.
        message:
          type: object
          description: The message content.

    SubmitSignedPaymentPermitRequest:
      type: object
      required: [signedPaymentPermit]
      properties:
        signedPaymentPermit:
          type: string
          description: The signed payment permit string to be broadcasted.
      example:
        signedPaymentPermit: "0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef1b"

    RampRequirements:
      type: object
      required: [type, piiEncryption]
      properties:
        type:
          type: string
          enum: [EncryptedPII]
          description: The type of ramp requirements.
        piiEncryption:
          $ref: "#/components/schemas/PIIEncryptionRequirement"
      example:
        piiEncryption:
          certificate:
            id: "c4d1da72-111e-4d52-bdbf-2e74a2d803d5"
            domain: "example.com"
            certPEM: "LS0tLS1CRUdJT..."
            jwk:
              kty: "EC"
              crv: "P-256"
              kid: "263521881931753643998528753619816524468853605762"
              x: "KnxBe8fb2mL_Ve9-tqjGSkGgE9f0yohMkAvH_InaFtE"
              y: "D41cVUpiKcey4LJKNFtUtmVHDWRmhjZapPLfryX5b1o"
          fieldRequirements:
            type: "object"
            required:
              - "originator.fullName"
              - "beneficiary.postalAddress"
            properties:
              originator.fullName:
                type: "string"
              beneficiary.postalAddress:
                type: "object"
                properties:
                  street:
                    type: "string"
                  city:
                    type: "string"
                  country:
                    type: "string"
          fileRequirements:
            - "ID_DOCUMENT"
            - "PROOF_OF_ADDRESS_DOCUMENT"
          supportedJWEAlgorithms:
            - "RSA-OAEP-256"
            - "ECDH-ES+A128KW"
          supportedJWEEncryptions:
            - "A128GCM"

    FieldRequirements:
      type: object
      description: JSON schema for the RFI requirements. Note that references use 'ref' instead of '$ref' to avoid YAML parsing issues.
      example:
        {
          "type": "object",
          "$defs": {
            "address": {
              "type": "object",
              "required": ["street", "city", "country"],
              "properties": {
                "city": {
                  "type": "string",
                  "description": "City name"
                },
                "street": {
                  "type": "string",
                  "description": "Street address"
                },
                "country": {
                  "type": "string",
                  "pattern": "^[A-Z]{2}$",
                  "description": "Country code (e.g., US, GB)"
                },
                "postalCode": {
                  "type": "string",
                  "description": "Postal or ZIP code"
                },
                "stateProvince": {
                  "type": "string",
                  "description": "State or province"
                }
              },
              "description": "Full address"
            },
            "individual": {
              "type": "object",
              "required": ["name", "address", "dateOfBirth"],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Individual's full name"
                },
                "address": { "ref": "#/$defs/address" },
                "dateOfBirth": {
                  "type": "string",
                  "format": "date",
                  "description": "Individual's date of birth (YYYY-MM-DD)"
                }
              },
              "description": "Individual's RFI data"
            },
            "beneficiaryOwner": {
              "type": "object",
              "required": [
                "name",
                "address",
                "dateOfBirth",
                "percentage"
              ],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Individual's full name"
                },
                "address": { "ref": "#/$defs/address" },
                "percentage": {
                  "type": "number",
                  "description": "Company ownership percentage"
                },
                "dateOfBirth": {
                  "type": "string",
                  "format": "date",
                  "description": "Individual's date of birth (YYYY-MM-DD)"
                }
              },
              "description": "Beneficiary owner's RFI data"
            },
            "intermediaryBeneficiaryOwner": {
              "type": "object",
              "required": [
                "name",
                "address",
                "dateOfFormation",
                "countryOfFormation",
                "percentage"
              ],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Business legal name"
                },
                "address": { "ref": "#/$defs/address" },
                "percentage": {
                  "type": "number",
                  "description": "Company ownership percentage"
                },
                "dateOfFormation": {
                  "type": "string",
                  "format": "date",
                  "description": "Company formation date (YYYY-MM-DD)"
                },
                "countryOfFormation": {
                  "type": "string",
                  "pattern": "^[A-Z]{2}$",
                  "description": "Entity formation country"
                }
              },
              "description": "Intermediary beneficiary owner's RFI data"
            }
          },
          "title": "RFI Requirements",
          "$schema": "https://json-schema.org/draft/2020-12/schema",
          "required": [
            "SOURCE_OF_FUNDS",
            "METHOD_OF_VERIFICATION",
            "NAME",
            "TRADE_NAME",
            "NATIONAL_IDENTIFICATION_NUMBER",
            "DATE_OF_FORMATION",
            "COUNTRY_OF_FORMATION",
            "ENTITY_TYPE",
            "INDUSTRY_TYPE",
            "ADDRESS",
            "AUTHORIZED_SIGNATORIES",
            "BENEFICIARY_OWNERSHIP"
          ],
          "properties": {
            "NAME": {
              "type": "string",
              "description": "Business legal registered name"
            },
            "EMAIL": {
              "type": "string",
              "description": "Business contact email address"
            },
            "PHONE": {
              "type": "string",
              "description": "Business contact phone number"
            },
            "ADDRESS": { "ref": "#/$defs/address" },
            "WEBSITE": {
              "type": "string",
              "description": "Business website URL"
            },
            "TRADE_NAME": {
              "type": "string",
              "description": "Business trade name or DBA (Doing Business As)"
            },
            "ENTITY_TYPE": {
              "type": "string",
              "description": "Business structure type (Corporation, LLC, Partnership, etc.)"
            },
            "INDUSTRY_TYPE": {
              "type": "string",
              "description": "Business activity classification"
            },
            "SOURCE_OF_FUNDS": {
              "type": "string",
              "description": "Transaction source of funds"
            },
            "DATE_OF_FORMATION": {
              "type": "string",
              "format": "date",
              "description": "Company formation date (YYYY-MM-DD)"
            },
            "BENEFICIARY_OWNERS": { "ref": "#/$defs/beneficiaryOwner" },
            "COUNTRY_OF_FORMATION": {
              "type": "string",
              "pattern": "^[A-Z]{2}$",
              "description": "Entity formation country"
            },
            "BENEFICIARY_OWNERSHIP": {
              "type": "boolean",
              "description": "Whether any individuals or intermediaries own 25% or more of the company"
            },
            "AUTHORIZED_SIGNATORIES": { "ref": "#/$defs/individual" },
            "METHOD_OF_VERIFICATION": {
              "type": "string",
              "description": "Verification method used"
            },
            "NATIONAL_IDENTIFICATION_NUMBER": {
              "type": "string",
              "description": "Business identification number (e.g., Tax ID)"
            },
            "INTERMEDIARY_BENEFICIARY_OWNERS": {
              "ref": "#/$defs/intermediaryBeneficiaryOwner"
            }
          },
          "description": "RFI Data Requirements"
        }

    PIICertificate:
      type: object
      required:
        - id
        - domain
        - certPEM
        - jwk
      properties:
        id:
          type: string
          description: Identifier for the certificate.
        domain:
          type: string
          description: Domain name which is available in the CommonName attribute of the cert.
        certPEM:
          type: string
          description: Base64 encoded certificate in PEM format.
        jwk:
          type: object
          description: JSON Web Key (JWK) representation of the certificate.
          required:
            - kty
            - crv
            - kid
            - x
            - y
          properties:
            kty:
              type: string
              description: Key type.
            crv:
              type: string
              description: Curve name.
            kid:
              type: string
              description: Key identifier.
            x:
              type: string
              description: X coordinate of the public key.
            y:
              type: string
              description: Y coordinate of the public key.
      example:
        id: "c4d1da72-111e-4d52-bdbf-2e74a2d803d5"
        domain: "example.com"
        certPEM: "LS0tLS1CRUdJT..."
        jwk:
          kty: "EC"
          crv: "P-256"
          kid: "263521881931753643998528753619816524468853605762"
          x: "KnxBe8fb2mL_Ve9-tqjGSkGgE9f0yohMkAvH_InaFtE"
          y: "D41cVUpiKcey4LJKNFtUtmVHDWRmhjZapPLfryX5b1o"

    RfiFileKey:
      type: string
      description: File key identifier for RFI document types.
      enum:
        - FORMATION_DOCUMENT
        - ORG_STRUCTURE
        - INVOICE
        - BENEFICIARY_OWNERS_DOCUMENT
        - ID_DOCUMENT
        - PROOF_OF_ADDRESS_DOCUMENT
        - ADDITIONAL_DOCUMENTS
      example: ID_DOCUMENT

    RfiFileType:
      type: string
      description: Supported MIME types for RFI file uploads.
      enum:
        - application/pdf
        - application/postscript
        - application/msword
        - application/x-msi
        - application/vnd.openxmlformats-officedocument.wordprocessingml.document
        - application/vnd.ms-excel
        - application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
        - image/jpeg
        - image/jp2
        - image/png
        - image/apng
        - image/heic
        - image/heif
        - text/csv
      example: application/pdf

    FileMetadata:
      type: object
      required:
        - fileName
        - fileType
        - fileKey
      properties:
        fileName:
          type: string
          description: Name of the file being submitted.
          example: "identity_document.pdf"
        fileType:
          $ref: "#/components/schemas/RfiFileType"
        fileKey:
          $ref: "#/components/schemas/RfiFileKey"
      description: Metadata about the file being uploaded.

    FileEncryption:
      type: object
      required:
        - encryptedAesKey
        - iv
      properties:
        encryptedAesKey:
          type: string
          format: jwe
          description: >-
            A JSON Web Encryption (JWE) compact string containing the encrypted AES key.
            The AES key should be encrypted using the certificate's public key with
            algorithm ECDH-ES+A128KW and encryption method A128GCM.
          example: "eyJhbGciOiJFQ0RILUVTK0ExMjhLVyIsImVuYyI6IkExMjhHQ00iLCJlcGsiOnsiY3J2IjoiUC0yNTYiLCJrdHkiOiJFQyIsIngiOiI1TEtTbUtsNmVYV0dQNHlGb2tVaks4RGppU0l5YWpQdzJ6UUp1YVhFbEZzIiwieSI6IlRVT29MTV8wc294b0UzYVFmSExlUzRlRkZ3RU9tZ1VDRUh1eDVRMXdVYTQifX0..."
        iv:
          type: string
          format: base64
          description: >-
            A Base64-encoded, 12-byte Initialization Vector (IV) used for AES-128-GCM encryption
            of the file contents.
          example: "a1b2c3d4e5f6g7h8i9j0"
      description: Encryption details required to decrypt the file.

    UploadRfiFileRequest:
      type: object
      required:
        - fileMetadata
        - encryption
        - encryptedFile
      properties:
        fileMetadata:
          $ref: "#/components/schemas/FileMetadata"
        encryption:
          $ref: "#/components/schemas/FileEncryption"
        encryptedFile:
          type: string
          format: binary
          description: >-
            The binary file content, encrypted using AES-128-GCM. The corresponding
            'encryptedAesKey' and 'iv' must be used for decryption.
      description: Request body for uploading an encrypted RFI file.

    PIIEncryptionRequirement:
      type: object
      required:
        - certificate
        - fieldRequirements
        - supportedJWEAlgorithms
        - supportedJWEEncryptions
      properties:
        certificate:
          $ref: "#/components/schemas/PIICertificate"
        fieldRequirements:
          $ref: "#/components/schemas/FieldRequirements"
        fileRequirements:
          type: array
          items:
            $ref: "#/components/schemas/RfiFileKey"
          description: List of required file types that must be encrypted and uploaded.
        supportedJWEAlgorithms:
          type: array
          items:
            type: string
          description: List of supported JWE algorithms (e.g., RSA-OAEP-256, ECDH-ES+A128KW).
        supportedJWEEncryptions:
          type: array
          items:
            type: string
          description: List of supported JWE encryption methods (e.g., A128GCM).
      description: >
        Defines the encryption requirements for PII data and supporting documents.


        **Field Data Encryption:**

        To construct the encrypted field data payload:

        1. Create a JSON object with the required fields from `fieldRequirements` JSON schema

        2. Encrypt the entire object using JSON Web Encryption (JWE) with:
           - The public key from the `certificate`
           - One of the algorithms from `supportedJWEAlgorithms`
           - One of the encryption methods from `supportedJWEEncryptions`

        3. The result will be a JWE Compact Serialization string to be sent as the encrypted payload.

        Example payload structure before encryption:
        ```json
        {
          "FULL_NAME": "John Doe",
          "DATE_OF_BIRTH": "1990-01-01",
          "ADDRESS": {
            "street": "123 Main St",
            "city": "New York",
            "country": "US"
          }
        }
        ```

        After encryption, this becomes a JWE string like:
        `eyJhbGciOiJSU0EtT0FFUC0yNTYiLCJlbmMiOiJBMTI4R0NNIn0.xxx.yyy.zzz.aaa`


        **File Encryption:**

        If `fileRequirements` is present, encrypt and upload files for each required document type:

        1. Generate a random 128-bit AES key for AES-128-GCM encryption

        2. Generate a random 12-byte Initialization Vector (IV)

        3. Encrypt the file contents using AES-128-GCM with the generated key and IV

        4. Encrypt the AES key using JWE with the certificate's public key:
           - Algorithm: ECDH-ES+A128KW
           - Encryption method: A128GCM

        5. Upload via multipart/form-data with:
           - `fileMetadata`: JSON object with `fileName`, `fileType`, `fileKey`
           - `encryption`: JSON object with `encryptedAesKey` (JWE string), `iv` (base64)
           - `encryptedFile`: The AES-encrypted file binary data

    RequestForInformation:
      type: object
      required: [id, type, encryptedPIIRequest]
      properties:
        id:
          type: string
          description: The ID of the request for information.
        type:
          type: string
          enum: [EncryptedPII]
          description: The type of request for information.
        encryptedPIIRequest:
          $ref: "#/components/schemas/PIIEncryptionRequirement"
      example:
        id: "123"
        type: "EncryptedPII"
        encryptedPIIRequest:
          certificate:
            id: "c4d1da72-111e-4d52-bdbf-2e74a2d803d5"
            domain: "example.com"
            certPEM: "LS0tLS1CRUdJT..."
            jwk:
              kty: "EC"
              crv: "P-256"
              kid: "263521881931753643998528753619816524468853605762"
              x: "KnxBe8fb2mL_Ve9-tqjGSkGgE9f0yohMkAvH_InaFtE"
              y: "D41cVUpiKcey4LJKNFtUtmVHDWRmhjZapPLfryX5b1o"
          fieldRequirements:
            type: "object"
            required:
              - "fullName.firstName"
              - "postalAddress.streetName"
            properties:
              fullName.firstName:
                type: "string"
              postalAddress.streetName:
                type: "string"
          fileRequirements:
            - "ID_DOCUMENT"
            - "PROOF_OF_ADDRESS_DOCUMENT"
          supportedJWEAlgorithms:
            - "RSA-OAEP-256"
            - "ECDH-ES+A128KW"
          supportedJWEEncryptions:
            - "A128GCM"

    RequestForInformationSubmission:
      type: object
      required: [rfiId, type, encryptedPII]
      properties:
        rfiId:
          type: string
          description: The ID of the request for information.
        type:
          type: string
          enum: [EncryptedPII]
          description: The type of request for information.
        encryptedPII:
          $ref: "#/x-schemas/JweString"

    RequestForInformationBulkSubmission:
      type: object
      required: [rfiSubmissions]
      properties:
        rfiSubmissions:
          type: array
          items:
            $ref: "#/components/schemas/RequestForInformationSubmission"

    Retry:
      type: object
      required:
        - type
        - slippage
      properties:
        type:
          type: string
          enum:
            - Retry
        slippage:
          type: number
          description: Slippage tolerance in basis points (bps) for quote orders - 1 is 0.01% and 10000 is 100%
        count:
          type: number
          description: If quote is expired, how many times to re-generate new quotes to try having the order executed as in the original quote.

    Market:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum:
            - Market

    Subscription:
      type: object
      required:
        - id
        - subscriberUrl
        - subscriptionPath
      properties:
        id: { type: string, format: uuid, readOnly: true }
        subscriberUrl:
          description: URL that will be notified when the target event occurs.
          type: string
          format: uri
        subscriptionPath:
          description: Path on which the subscription was registered.
          type: string
          readOnly: true
          example: /withdrawals/subscriptions/finalized
